<!DOCTYPE html>

<html>
<head>
  <title>storeActions.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="Gruntfile.html">
                  Gruntfile.js
                </a>
              
                
                <a class="source" href="audio.html">
                  audio.js
                </a>
              
                
                <a class="source" href="execShellCommand.html">
                  execShellCommand.js
                </a>
              
                
                <a class="source" href="buildCommands.html">
                  buildCommands.js
                </a>
              
                
                <a class="source" href="commandsCTRL.html">
                  commandsCTRL.js
                </a>
              
                
                <a class="source" href="phrases.html">
                  phrases.js
                </a>
              
                
                <a class="source" href="saveAndWrite.html">
                  saveAndWrite.js
                </a>
              
                
                <a class="source" href="updateCommands.html">
                  updateCommands.js
                </a>
              
                
                <a class="source" href="configUtils.html">
                  configUtils.js
                </a>
              
                
                <a class="source" href="cmdRec.html">
                  cmdRec.js
                </a>
              
                
                <a class="source" href="listener.html">
                  listener.js
                </a>
              
                
                <a class="source" href="prefixRec.html">
                  prefixRec.js
                </a>
              
                
                <a class="source" href="speechRecognition.html">
                  speechRecognition.js
                </a>
              
                
                <a class="source" href="formatVariable.html">
                  formatVariable.js
                </a>
              
                
                <a class="source" href="matchCtrl.html">
                  matchCtrl.js
                </a>
              
                
                <a class="source" href="matchingUtil.html">
                  matchingUtil.js
                </a>
              
                
                <a class="source" href="parseCommands.html">
                  parseCommands.js
                </a>
              
                
                <a class="source" href="prefixTrie.html">
                  prefixTrie.js
                </a>
              
                
                <a class="source" href="regMatch.html">
                  regMatch.js
                </a>
              
                
                <a class="source" href="JWDTest.html">
                  JWDTest.js
                </a>
              
                
                <a class="source" href="getMatchByScore.html">
                  getMatchByScore.js
                </a>
              
                
                <a class="source" href="phoneticsTest.html">
                  phoneticsTest.js
                </a>
              
                
                <a class="source" href="testCommands.html">
                  testCommands.js
                </a>
              
                
                <a class="source" href="core-utils.html">
                  core-utils.js
                </a>
              
                
                <a class="source" href="loaders.html">
                  loaders.js
                </a>
              
                
                <a class="source" href="phraseTrie.html">
                  phraseTrie.js
                </a>
              
                
                <a class="source" href="utils.html">
                  utils.js
                </a>
              
                
                <a class="source" href="actions.html">
                  actions.js
                </a>
              
                
                <a class="source" href="about.html">
                  about.js
                </a>
              
                
                <a class="source" href="appContainer.html">
                  appContainer.js
                </a>
              
                
                <a class="source" href="contact.html">
                  contact.js
                </a>
              
                
                <a class="source" href="landing.html">
                  landing.js
                </a>
              
                
                <a class="source" href="layout.html">
                  layout.js
                </a>
              
                
                <a class="source" href="commandsTable.html">
                  commandsTable.js
                </a>
              
                
                <a class="source" href="packages.html">
                  packages.js
                </a>
              
                
                <a class="source" href="settings.html">
                  settings.js
                </a>
              
                
                <a class="source" href="constants.html">
                  constants.js
                </a>
              
                
                <a class="source" href="dispatcher.html">
                  dispatcher.js
                </a>
              
                
                <a class="source" href="main.html">
                  main.js
                </a>
              
                
                <a class="source" href="mixins.html">
                  mixins.js
                </a>
              
                
                <a class="source" href="store.html">
                  store.js
                </a>
              
                
                <a class="source" href="storeActions.html">
                  storeActions.js
                </a>
              
                
                <a class="source" href="main.html">
                  main.js
                </a>
              
                
                <a class="source" href="commands-util.spec.html">
                  commands-util.spec.js
                </a>
              
                
                <a class="source" href="matching.spec.html">
                  matching.spec.js
                </a>
              
                
                <a class="source" href="parsing.spec.html">
                  parsing.spec.js
                </a>
              
                
                <a class="source" href="phraseTrie.spec.html">
                  phraseTrie.spec.js
                </a>
              
                
                <a class="source" href="commands.html">
                  commands.js
                </a>
              
                
                <a class="source" href="matching-test-cases.html">
                  matching-test-cases.js
                </a>
              
                
                <a class="source" href="phrases-tmp.html">
                  phrases-tmp.js
                </a>
              
                
                <a class="source" href="webpack.config.html">
                  webpack.config.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>storeActions.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> { updateCommands, loadPackage } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../commandsCTRL/commandsCTRL'</span>;
<span class="hljs-keyword">import</span> { writeConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../configCTRL/configUtils'</span>;
<span class="hljs-keyword">import</span> Constants <span class="hljs-keyword">from</span> <span class="hljs-string">'../constants/constants'</span>;
<span class="hljs-keyword">import</span> { getCommands } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../utils/utils'</span>;
<span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'underscore'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getCommands</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> getCommands().packageCommands;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>_liveUpdateCommand live updates the command - if you make changes in the view
_liveUpdateCommand will update the _commands array in the store.</p>
<p>it takes an object which tells the store what changes are being made:
index - the index of the command being edited
change - is the change being made
type - command or action field</p>
<p>we then find the index of the command being edited in _commands and
changes the object live.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_liveUpdateCommand</span>(<span class="hljs-params">_commands, command</span>) </span>{
  <span class="hljs-keyword">const</span> { index, change, type } = command;
  <span class="hljs-keyword">const</span> oldCommand = <span class="hljs-built_in">Object</span>.keys(_commands[index])[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (type === Constants.ACTION) {
    _commands[index][oldCommand] = change;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === Constants.COMMAND) {
    <span class="hljs-keyword">const</span> action = _commands[index][oldCommand];
    _commands[index] = {
      [change]: action };
  }
  <span class="hljs-keyword">return</span> _commands;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>takes the commands object from commandsUtil and converts it to an array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_reloadCommands</span>(<span class="hljs-params">commandsObj</span>) </span>{
  <span class="hljs-keyword">const</span> results = <span class="hljs-built_in">Object</span>.keys(commandsObj)
    .reduce((arr, cmd) =&gt; {
      <span class="hljs-keyword">return</span> arr.concat({
        [cmd]: commandsObj[cmd] });
    }, []);
  <span class="hljs-keyword">return</span> results;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>_saveCommands takes the _commands array from the store and
reduces it back into one commandsObj. It is then shipped off
to updateCommands in the commandsUtils where the updated commands
are merged into the commandsObj, saved and written</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_saveCommands</span>(<span class="hljs-params">commands, cb</span>) </span>{
  <span class="hljs-keyword">const</span> packageCommands = commands.reduce((cmdObj, cmd) =&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(cmd) === <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">return</span> cmdObj;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign(cmdObj, cmd);
  }, {});
  updateCommands(packageCommands, (err, cmd) =&gt; {
    cb(<span class="hljs-literal">null</span>, _reloadCommands(cmd));
  });
}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>adds an empty object into a field, then saves
the changes in the commandsUtil</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_addCommand</span>(<span class="hljs-params">commands, cb</span>) </span>{
  commands.push({
    <span class="hljs-string">'command'</span>: <span class="hljs-string">'action'</span> });
  _saveCommands(commands, (err, cmd) =&gt; {
    cb(<span class="hljs-literal">null</span>, cmd);
  });
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_loadPackage</span>(<span class="hljs-params">filePath, cb</span>) </span>{
  writeConfig({
    commandsPath: filePath,
    phrasesPath: filePath.replace(<span class="hljs-string">'commands.'</span>, <span class="hljs-string">'phrases.'</span>) }, (err, data) =&gt; {
    loadPackage(data, cb);
  });
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_saveConfig</span>(<span class="hljs-params">config, cb</span>) </span>{
  writeConfig(config, (err, data) =&gt; {
    cb(err, data);
  });
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getConfig</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> name = localStorage.getItem(<span class="hljs-string">'name'</span>);
  <span class="hljs-keyword">const</span> exactMatchThreshold = <span class="hljs-built_in">parseFloat</span>(localStorage.getItem(<span class="hljs-string">'exactMatchThreshold'</span>));
  <span class="hljs-keyword">const</span> closeMatchThreshold = <span class="hljs-built_in">parseFloat</span>(localStorage.getItem(<span class="hljs-string">'closeMatchThreshold'</span>));
  <span class="hljs-keyword">return</span> {
    name,
    exactMatchThreshold,
    closeMatchThreshold };
}


<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_deleteCommand</span>(<span class="hljs-params">command, cb</span>) </span>{
  _saveCommands(command, cb);
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_updateConfig</span>(<span class="hljs-params">oldConfig, newConfig</span>) </span>{
  <span class="hljs-keyword">return</span> _.extend(oldConfig, newConfig);
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
